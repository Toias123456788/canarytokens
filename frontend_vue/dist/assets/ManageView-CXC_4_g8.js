function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/ManageToken-CnoDdaOE.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-BZClGGG3.js","assets/index-5VSA5TjA.js","assets/index-WsMomUVa.css","assets/ManageToken-BBbEFt_U.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-qMFWtiYD.js","assets/BaseCodeSnippet.vue_vue_type_script_setup_true_lang-DJzrpp7C.js","assets/BaseCodeSnippet-BgyOUOV9.css","assets/ManageToken-CZQl4hOw.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-DQWWJNjM.js","assets/ManageToken-D2_ozBTM.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-c5fhhdyu.js","assets/ManageToken-BSQvyVYP.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-BFJI_gU_.js","assets/BaseSwitch-DG6Eo7c6.js","assets/BaseSwitch-CoEKGRnn.css","assets/ManageToken-Dgpjs15i.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-CTmids05.js","assets/ManageToken-DSnOT3vC.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-CGBaJ68_.js","assets/ManageToken-DmMvP481.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-DqexAUGt.js","assets/ManageToken-m0h6SA8s.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-BUWOrtjn.js","assets/ManageToken-GJNYhJ1C.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-DKIYEvzJ.js","assets/ManageToken-DERQuPjx.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-F1mPqDBX.js","assets/ManageToken-B9LPTWVu.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-DGRgsRBg.js","assets/ManageToken-C80Ep09p.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-DIkUU-kK.js","assets/ManageToken-3ymALGMe.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-CrCgG_0D.js","assets/ManageToken-B6K3LTXn.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-ydPUkmED.js","assets/ManageToken-CDZALE57.js","assets/ManageToken-tLwHrJ_P.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-Doi2Kq0F.js","assets/ManageToken-D_rndN8T.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-BDxo4J1O.js","assets/ManageToken-Dc5VdWyd.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-B7YwRX8q.js","assets/ManageToken-CEMT20v2.js","assets/generateSVNToken-BmwI51UM.js","assets/ManageToken-CitzI8ic.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-bDe3ClHF.js","assets/ManageToken-RzAW2G5X.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-DmeqlTOL.js","assets/ManageToken-rkSC8ZGq.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-BgbweLIr.js","assets/ManageToken-B4j3tabv.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-C4srM3z4.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{A as D}from"./AppLayoutOneColumn-cS12tPcB.js";import{d as L,r as i,o as P,S as r,a as u,c as h,b as v,w as I,u as g,e as k,T as x,G as W,U as N,s as G,_ as $,f as H,g as f,h as d,i as K,j as U,k as j,l as b,m as q,n as Y,t as S,p as C,q as y,v as z,x as F,y as J,F as Z,z as Q,A as X,B as ee,C as ae,D as oe,E as a}from"./index-5VSA5TjA.js";import{_ as ne}from"./BaseSwitch-DG6Eo7c6.js";import{B as te}from"./BannerDeviceCanarytools-CqkbUCXx.js";const se={class:"flex flex-col gap-24"},w="An error occurred. Please try again.",re=L({__name:"SettingsToken",props:{tokenBackendResponse:{}},setup(A){const s=A;function E(){return s.tokenBackendResponse.canarydrop.type===x.WEB_BUG||s.tokenBackendResponse.canarydrop.type===x.WEB_IMAGE}function T(){return s.tokenBackendResponse.canarydrop.type===x.WEB_IMAGE}const B=i(s.tokenBackendResponse.canarydrop.alert_email_recipient),c=i(s.tokenBackendResponse.canarydrop.alert_webhook_url),O=i(E()),M=i(T()),o=i({[r.EMAIL]:!1,[r.WEB_HOOK]:!1,[r.BROWSER_SCANNER]:!1,[r.WEB_IMAGE]:!1}),p=i({[r.EMAIL]:!1,[r.WEB_HOOK]:!1,[r.BROWSER_SCANNER]:!1,[r.WEB_IMAGE]:!1}),l=i({[r.EMAIL]:!1,[r.WEB_HOOK]:!1,[r.BROWSER_SCANNER]:!1,[r.WEB_IMAGE]:!1});P(()=>{Object.keys(r).forEach(t=>{const e=W[t];o.value[t]=!!s.tokenBackendResponse.canarydrop[e],p.value[t]=!1,l.value[t]=!1})});function V(t){return t?"on":"off"}async function R(t,e){var n;const _={value:V(e),token:(n=s.tokenBackendResponse.canarydrop.canarytoken)==null?void 0:n._value,auth:s.tokenBackendResponse.canarydrop.auth,setting:N[t]};Object.keys(l.value).forEach(m=>{l.value[m]=!1}),p.value[t]=!0;try{const m=await G(_);m.status===200?o.value[t]=e:(console.log("Error:",m.data.detail),l.value[t]=!0)}catch(m){console.log(m,"error!"),l.value[t]=!0}finally{p.value[t]=!1}}return(t,e)=>{const _=ne;return u(),h("div",se,[B.value?(u(),v(_,{key:0,id:"email-alert",modelValue:o.value.EMAIL,"onUpdate:modelValue":e[0]||(e[0]=n=>o.value.EMAIL=n),label:"Email alerts","helper-message":t.tokenBackendResponse.canarydrop.alert_email_recipient,loading:p.value.EMAIL,"has-error":l.value.EMAIL,"error-message":w,onClick:e[1]||(e[1]=I(n=>R(g(r).EMAIL,!o.value.EMAIL),["prevent"]))},null,8,["modelValue","helper-message","loading","has-error"])):k("",!0),c.value?(u(),v(_,{key:1,id:"webhook-alert",modelValue:o.value.WEB_HOOK,"onUpdate:modelValue":e[2]||(e[2]=n=>o.value.WEB_HOOK=n),label:"Webhook reporting","helper-message":s.tokenBackendResponse.canarydrop.alert_webhook_url,loading:p.value.WEB_HOOK,"has-error":l.value.WEB_HOOK,"error-message":w,onClick:e[3]||(e[3]=I(n=>R(g(r).WEB_HOOK,!o.value.WEB_HOOK),["prevent"]))},null,8,["modelValue","helper-message","loading","has-error"])):k("",!0),O.value?(u(),v(_,{key:2,id:"browser-alert",modelValue:o.value.BROWSER_SCANNER,"onUpdate:modelValue":e[4]||(e[4]=n=>o.value.BROWSER_SCANNER=n),label:"Browser scanner","helper-message":"Runs Javascript fingerprinting when the token is browsed",loading:p.value.BROWSER_SCANNER,"has-error":l.value.BROWSER_SCANNER,"error-message":w,onClick:e[5]||(e[5]=I(n=>R(g(r).BROWSER_SCANNER,!o.value.BROWSER_SCANNER),["prevent"]))},null,8,["modelValue","loading","has-error"])):k("",!0),M.value?(u(),v(_,{key:3,id:"custom-image",modelValue:o.value.WEB_IMAGE,"onUpdate:modelValue":e[6]||(e[6]=n=>o.value.WEB_IMAGE=n),label:"Custom web image","helper-message":"Serve your alternative image",loading:p.value.WEB_IMAGE,"has-error":l.value.WEB_IMAGE,"error-message":w,onClick:e[7]||(e[7]=I(n=>R(g(r).WEB_IMAGE,!o.value.WEB_IMAGE),["prevent"]))},null,8,["modelValue","loading","has-error"])):k("",!0)])}}}),le={},_e=f("h3",{class:"inline-block mb-8 text-grey-500"},"Your Memo for this token",-1),ue={class:"flex flex-row items-center self-start flex-grow gap-16 py-8 w-full bg-grey-100 rounded-xl min-h-[3rem] text-grey"},ie={class:"py-8 text-pretty"};function ce(A,s){const E=H("font-awesome-icon");return u(),h("div",null,[_e,f("div",ue,[d(E,{icon:"quote-left",class:"pl-16 text-2xl text-grey-300"}),f("p",ie,[K(A.$slots,"default")])])])}const de=$(le,[["render",ce]]),pe={key:0,class:"flex flex-col items-center gap-8 mb-24"},me=["src","alt"],ve={class:"text-xl text-center text-grey-800"},ke={key:1,class:"flex flex-col items-center w-full gap-8"},Ee={key:3,class:"flex flex-col justify-center p-16 md:p-32 md:mx-32 rounded-xl bg-grey-50 md:max-w-[50vw] w-full"},ge={class:"flex flex-col w-full gap-8"},fe=["innerHTML"],Te=L({__name:"ManageToken",setup(A){const s=U(),E=j(),T=i(!1),B=i(null),c=i(),O=i(),M=i({props:{}}),o=i(0),p=b(()=>o.value?`This Token has been triggered <span class="font-bold">${o.value}</span> time${o.value>1?"s":""}`:"This Token has never been triggered"),l=b(()=>c.value.canarydrop.expected_referrer==="microsoftonline.com"?x.AZURE_ENTRA_CONFIG:c.value.canarydrop.type);function V(){const e=s.params.auth,_=s.params.token;E.push({name:"history",params:{auth:e,token:_}})}async function R(){T.value=!0;const e={auth:s.params.auth,token:s.params.token};try{const _=await ae(e);T.value=!1,c.value=_.data,O.value=`token_icons/${S[l.value].icon}`,o.value=c.value.canarydrop.triggered_details.hits.length,t()}catch(_){console.log(_,"err!"),B.value=_.toString(),E.push({name:"error"})}finally{T.value=!1}}async function t(){M.value=await Q(()=>oe(Object.assign({"./tokens/adobe_pdf/ManageToken.vue":()=>a(()=>import("./ManageToken-CnoDdaOE.js"),__vite__mapDeps([0,1,2,3])),"./tokens/aws_keys/ManageToken.vue":()=>a(()=>import("./ManageToken-BBbEFt_U.js"),__vite__mapDeps([4,5,6,2,3,7])),"./tokens/azure_id/ManageToken.vue":()=>a(()=>import("./ManageToken-CZQl4hOw.js"),__vite__mapDeps([8,9,2,3,6,7])),"./tokens/azure_id_config/ManageToken.vue":()=>a(()=>import("./ManageToken-D2_ozBTM.js"),__vite__mapDeps([10,11,2,3])),"./tokens/clonedsite/ManageToken.vue":()=>a(()=>import("./ManageToken-BSQvyVYP.js"),__vite__mapDeps([12,13,14,2,3,15,6,7])),"./tokens/cmd/ManageToken.vue":()=>a(()=>import("./ManageToken-Dgpjs15i.js"),__vite__mapDeps([16,17,2,3])),"./tokens/cssclonedsite/ManageToken.vue":()=>a(()=>import("./ManageToken-DSnOT3vC.js"),__vite__mapDeps([18,19,6,2,3,7])),"./tokens/dns/ManageToken.vue":()=>a(()=>import("./ManageToken-DmMvP481.js"),__vite__mapDeps([20,21,6,2,3,7])),"./tokens/fast_redirect/ManageToken.vue":()=>a(()=>import("./ManageToken-m0h6SA8s.js"),__vite__mapDeps([22,23,6,2,3,7])),"./tokens/kubeconfig/ManageToken.vue":()=>a(()=>import("./ManageToken-GJNYhJ1C.js"),__vite__mapDeps([24,25,2,3])),"./tokens/log4shell/ManageToken.vue":()=>a(()=>import("./ManageToken-DERQuPjx.js"),__vite__mapDeps([26,27,6,2,3,7])),"./tokens/ms_excel/ManageToken.vue":()=>a(()=>import("./ManageToken-B9LPTWVu.js"),__vite__mapDeps([28,29,2,3])),"./tokens/ms_word/ManageToken.vue":()=>a(()=>import("./ManageToken-C80Ep09p.js"),__vite__mapDeps([30,31,2,3])),"./tokens/my_sql/ManageToken.vue":()=>a(()=>import("./ManageToken-3ymALGMe.js"),__vite__mapDeps([32,33,14,2,3,15,6,7])),"./tokens/qr_code/ManageToken.vue":()=>a(()=>import("./ManageToken-B6K3LTXn.js"),__vite__mapDeps([34,35,2,3])),"./tokens/signed_exe/ManageToken.vue":()=>a(()=>import("./ManageToken-CDZALE57.js"),__vite__mapDeps([36,2,3])),"./tokens/slow_redirect/ManageToken.vue":()=>a(()=>import("./ManageToken-tLwHrJ_P.js"),__vite__mapDeps([37,38,6,2,3,7])),"./tokens/smtp/ManageToken.vue":()=>a(()=>import("./ManageToken-D_rndN8T.js"),__vite__mapDeps([39,40,6,2,3,7])),"./tokens/sql_server/ManageToken.vue":()=>a(()=>import("./ManageToken-Dc5VdWyd.js"),__vite__mapDeps([41,42,6,2,3,7])),"./tokens/svn/ManageToken.vue":()=>a(()=>import("./ManageToken-CEMT20v2.js"),__vite__mapDeps([43,44,6,2,3,7])),"./tokens/web/ManageToken.vue":()=>a(()=>import("./ManageToken-CitzI8ic.js"),__vite__mapDeps([45,46,6,2,3,7])),"./tokens/web_image/ManageToken.vue":()=>a(()=>import("./ManageToken-RzAW2G5X.js"),__vite__mapDeps([47,48,6,2,3,7])),"./tokens/windows_dir/ManageToken.vue":()=>a(()=>import("./ManageToken-rkSC8ZGq.js"),__vite__mapDeps([49,50,2,3])),"./tokens/wireguard/ManageToken.vue":()=>a(()=>import("./ManageToken-B4j3tabv.js"),__vite__mapDeps([51,52,6,2,3,7]))}),`./tokens/${l.value}/ManageToken.vue`))}return t(),q(()=>s.params.token,R,{immediate:!0}),(e,_)=>{const n=X,m=ee;return u(),h(Z,null,[c.value?(u(),h("div",pe,[f("img",{src:g(Y)(O.value),class:"h-[4rem]","aria-hidden":"true",alt:`${g(S)[l.value].label} logo`},null,8,me),f("h2",ve,C(g(S)[l.value].label),1)])):k("",!0),T.value?(u(),h("div",ke,[d(n,{type:"circle",class:"w-[60px] h-[60px]"}),d(n,{type:"header",class:"w-[200px]"}),d(n,{type:"rectangle",class:"md:max-w-[50vw] w-full h-[250px] mt-16"})])):k("",!0),B.value?(u(),v(m,{key:2,variant:"danger",message:"Oh no! Something went wrong when managing your token data. Please refresh the page or try again later."})):k("",!0),c.value?(u(),h("div",Ee,[(u(),v(F,null,{fallback:y(()=>[f("div",ge,[d(n,{class:"w-[100px]",type:"text"}),d(n,{class:"w-full",type:"header"})])]),default:y(()=>[(u(),v(z(M.value),{"token-backend-response":c.value},null,8,["token-backend-response"]))]),_:1})),d(de,{class:"mt-32"},{default:y(()=>[J(C(c.value.canarydrop.memo),1)]),_:1}),d(re,{"token-backend-response":c.value,class:"mt-32"},null,8,["token-backend-response"]),d(m,{class:"mt-32",variant:o.value?"danger":"info","text-link":o.value?"Check History":"",onClick:V},{default:y(()=>[f("span",{innerHTML:p.value},null,8,fe)]),_:1},8,["variant","text-link"]),d(te,{class:"mb-8"})])):k("",!0)],64)}}}),Be=L({__name:"ManageView",setup(A){return(s,E)=>(u(),v(D,null,{default:y(()=>[d(Te)]),_:1}))}});export{Be as default};

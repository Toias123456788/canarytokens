import{_ as T}from"./BaseSwitch-DjTRDj27.js";import{d as R,r as u,o as S,a as A,c as M,i as c,j as b,h as C,w as f,F as k,f as r,W as h,X as D}from"./index-WLcRglgj.js";import{_ as O}from"./BaseCodeSnippet.vue_vue_type_script_setup_true_lang-B8DK0ueW.js";function p(s,e,o){const n=`SET @bb = CONCAT("CHANGE MASTER TO MASTER_PASSWORD='my-secret-pw', MASTER_RETRY_COUNT=1, MASTER_PORT=3306, MASTER_HOST='${s}', MASTER_USER='${e}", @@lc_time_names, @@hostname, "';")`,d=btoa(`SET @bb = CONCAT("CHANGE MASTER TO MASTER_PASSWORD='my-secret-pw', MASTER_RETRY_COUNT=1, MASTER_PORT=3306, MASTER_HOST='${s}', MASTER_USER='${e}", @@lc_time_names, @@hostname, "';"`);return o?`SET @b = ${d}; 
SET @s2 = FROM_BASE64(@b);
PREPARE stmt1 FROM @s2;
EXECUTE stmt1;
PREPARE stmt2 FROM @bb;
EXECUTE stmt2;
START REPLICA;`:`${n}; 
PREPARE stmt FROM @bb;
EXECUTE stmt;
START REPLICA;`}const w=r("p",{class:"mt-16 mb-16"},"1. Insert it into a MySQL dump of your own",-1),y=r("p",{class:"mt-32"}," 2. Download a (pseudo) random MySQL dump with a token already embedded in it ",-1),N=R({__name:"TokenDisplay",props:{tokenData:{}},setup(s){const e=s,o=u(e.tokenData.encoded||!0),n=u("");S(()=>{n.value=p(e.tokenData.hostname,e.tokenData.token,o.value)});function d(){o.value=!o.value,n.value=p(e.tokenData.hostname,e.tokenData.token,o.value)}function m(){var t,l;const _={fmt:"my_sql",auth:(t=e.tokenData)==null?void 0:t.auth,token:(l=e.tokenData)==null?void 0:l.token,encoded:o.value};h(_).then(a=>{window.location.href=a.request.responseURL}).catch(a=>{console.log(a,"err")}).finally(()=>{console.log("File downloaded")})}return(_,t)=>{const l=O,a=D,i=T;return A(),M(k,null,[w,c(l,{lang:"sql",label:"Your MYSQL code",code:n.value},null,8,["code"]),y,c(a,{class:"mt-16",onClick:m},{default:b(()=>[C("Download a MySQL Dump file")]),_:1}),c(i,{id:"encoded_mysql",modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=E=>o.value=E),class:"mt-16",label:"Encode Snippet","helper-message":"Encode snippet to make it harder to spot",onInput:t[1]||(t[1]=f(E=>d(),["stop"]))},null,8,["modelValue"])],64)}}});export{N as _};
